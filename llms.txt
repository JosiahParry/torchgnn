# torchgnn

Graph Neural Networks for [`{torch}`](https://mlverse.github.io/torch/)
in R.

## Installation

Install the development version of the package using

``` r
pak::pak("josiahparry/torchgnn")
```

## Usage

Use `gcn_model()` to create a high level model:

``` r
library(torchgnn)

gcn_model(
  in_features = 14,
  hidden_dims = c(56, 56),
  out_features = 1,
  output_activation = torch::nnf_sigmoid
)
```

``` R
An `nn_module` containing 8,065 parameters.

── Modules ─────────────────────────────────────────────────────────────────────
• layers: <nn_module_list> #8,065 parameters
```

Or create individual layers using `gcn_layer()`:

``` r
gcn_layer(10, 1)
```

``` R
An `nn_module` containing 21 parameters.

── Modules ─────────────────────────────────────────────────────────────────────
• theta: <nn_linear> #10 parameters
• phi: <nn_linear> #10 parameters

── Parameters ──────────────────────────────────────────────────────────────────
• psi: Float [1:1, 1:1]
```

# Package index

## All functions

- [`adj_from_edgelist()`](https://josiahparry.github.io/torchgnn/reference/adj_from_edgelist.md)
  : Create Sparse Adjacency Matrix from Edge List
- [`gcn_normalize()`](https://josiahparry.github.io/torchgnn/reference/adjacency.md)
  [`adj_row_normalize()`](https://josiahparry.github.io/torchgnn/reference/adjacency.md)
  [`add_graph_self_loops()`](https://josiahparry.github.io/torchgnn/reference/adjacency.md)
  : Add self-loops to a graph
- [`gcn_conv_layer()`](https://josiahparry.github.io/torchgnn/reference/gcn_conv_layer.md)
  : GCN Convolutional Layer (Kipf & Welling 2016)
- [`gcn_conv_model()`](https://josiahparry.github.io/torchgnn/reference/gcn_conv_model.md)
  : Multi-layer GCN Model
- [`gcn_general_layer()`](https://josiahparry.github.io/torchgnn/reference/gcn_general_layer.md)
  : Generalized GCN Layer (Hamilton 2020)
- [`gcn_general_model()`](https://josiahparry.github.io/torchgnn/reference/gcn_general_model.md)
  : Multi-layer Generalized GCN Model (Hamilton 2020)
- [`graph_split()`](https://josiahparry.github.io/torchgnn/reference/graph_split.md)
  : Create Train/Validation/Test Split for Graph Data
- [`nodes_to_tensor()`](https://josiahparry.github.io/torchgnn/reference/nodes_to_tensor.md)
  : Convert Node Features to Tensor
- [`regconv_layer()`](https://josiahparry.github.io/torchgnn/reference/regconv_layer.md)
  : Regional GCN Convolutional Layer (Guo et al. 2025)

