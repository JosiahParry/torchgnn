<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Graph Neural Network Extensions for `torch` â€¢ torchgnn</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Graph Neural Network Extensions for `torch`">
<meta name="description" content="What the package does (one paragraph).">
<meta property="og:description" content="What the package does (one paragraph).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">torchgnn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="torchgnn">torchgnn<a class="anchor" aria-label="anchor" href="#torchgnn"></a>
</h1></div>
<p>Graph Neural Networks for <a href="https://mlverse.github.io/torch/" class="external-link"><code>{torch}</code></a> in R.</p>
<p><strong>Currently supports:</strong> Graph Convolutional Networks (GCN) as described in Kipf &amp; Welling (2017) and the Generalized GCN as described by Hamilton (2020).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the development version:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"josiahparry/torchgnn"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-functions">Key Functions<a class="anchor" aria-label="anchor" href="#key-functions"></a>
</h2>
<div class="section level3">
<h3 id="model-building">Model Building<a class="anchor" aria-label="anchor" href="#model-building"></a>
</h3>
<ul>
<li>
<code><a href="reference/gcn_conv_model.html">gcn_conv_model()</a></code>: High-level GCN model with multiple layers</li>
<li>
<code><a href="reference/gcn_general_model.html">gcn_general_model()</a></code>: Generalized GCN with multiple layers</li>
<li>
<code><a href="reference/gcn_conv_layer.html">gcn_conv_layer()</a></code>: Standard GCN layer</li>
<li>
<code><a href="reference/gcn_general_layer.html">gcn_general_layer()</a></code>: Generlized GCN layer from Hamilton 2020</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<ul>
<li>
<code>adj_from_edgelist(from, to)</code>: Create sparse adjacency matrix from edge list (supports character IDs)</li>
<li>
<code>nodes_to_tensor(nodes, adj, node_id)</code>: Convert node features dataframe to tensor with correct ordering</li>
<li>
<code>graph_split(X, seed)</code>: Create train/validation/test splits</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="creating-models">Creating Models<a class="anchor" aria-label="anchor" href="#creating-models"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josiahparry.github.io/torchgnn/">torchgnn</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multi-layer GCN</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gcn_conv_model.html">gcn_conv_model</a></span><span class="op">(</span></span>
<span>  in_features <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  hidden_dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>  out_features <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  dropout <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single layer</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu">gcn_layer</span><span class="op">(</span><span class="fl">500</span>, <span class="fl">32</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-with-graph-data">Working with Graph Data<a class="anchor" aria-label="anchor" href="#working-with-graph-data"></a>
</h3>
<p>The package provides helpers for converting graph data to tensors:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create adjacency matrix (handles character node IDs)</span></span>
<span><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/adj_from_edgelist.html">adj_from_edgelist</a></span><span class="op">(</span><span class="va">edges</span><span class="op">$</span><span class="va">from</span>, <span class="va">edges</span><span class="op">$</span><span class="va">to</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert node features (automatically orders by adjacency matrix)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nodes_to_tensor.html">nodes_to_tensor</a></span><span class="op">(</span><span class="va">node_features</span>, <span class="va">adj</span>, node_id <span class="op">=</span> <span class="st">"node_id_column"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is taken from the examples directory.</p>
<p>Train a GCN on the PubMed Diabetes citation network for document classification:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://torch.mlverse.org/docs" class="external-link">torch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">'dplyr'</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>The following objects are masked from <span class="st">'package:stats'</span><span class="sc">:</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    filter, lag</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>The following objects are masked from <span class="st">'package:base'</span><span class="sc">:</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    intersect, setdiff, setequal, union</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josiahparry.github.io/torchgnn/">torchgnn</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/nanoparquet" class="external-link">nanoparquet</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read to tempfiles</span></span>
<span><span class="co"># data from https://linqs.org/datasets/#pubmed-diabetes</span></span>
<span><span class="va">nodes_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"nodes"</span>, fileext <span class="op">=</span> <span class="st">".parquet"</span><span class="op">)</span></span>
<span><span class="va">edges_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"edges"</span>, fileext <span class="op">=</span> <span class="st">".parquet"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://github.com/JosiahParry/torchgnn/raw/refs/heads/main/examples/data/pubmed-diabetes/edges.parquet"</span>,</span>
<span>  <span class="va">edges_tmp</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://github.com/JosiahParry/torchgnn/raw/refs/heads/main/examples/data/pubmed-diabetes/nodes.parquet"</span>,</span>
<span>  <span class="va">nodes_tmp</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read in the nodes and edges</span></span>
<span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu">read_parquet</span><span class="op">(</span><span class="va">nodes_tmp</span><span class="op">)</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu">read_parquet</span><span class="op">(</span><span class="va">edges_tmp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create our adjacency matrix from IDs</span></span>
<span><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/adj_from_edgelist.html">adj_from_edgelist</a></span><span class="op">(</span><span class="va">edges</span><span class="op">$</span><span class="va">from</span>, <span class="va">edges</span><span class="op">$</span><span class="va">to</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create our training data tensor</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nodes_to_tensor.html">nodes_to_tensor</a></span><span class="op">(</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">nodes</span>, <span class="op">-</span><span class="va">label</span><span class="op">)</span>,</span>
<span>  <span class="va">adj</span>,</span>
<span>  node_id <span class="op">=</span> <span class="st">"paper_id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create our target class tensor</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nodes_to_tensor.html">nodes_to_tensor</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">nodes</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="va">adj</span>, <span class="st">"paper_id"</span><span class="op">)</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span></span>
<span>  dtype <span class="op">=</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_dtype.html" class="external-link">torch_long</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="fu">squeeze</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># perform a train, test, validation split</span></span>
<span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/graph_split.html">graph_split</a></span><span class="op">(</span><span class="va">X</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define a 2 layer GCN model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gcn_conv_model.html">gcn_conv_model</a></span><span class="op">(</span></span>
<span>  <span class="co"># number of variables</span></span>
<span>  in_features <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  <span class="co"># define our hidden layers</span></span>
<span>  hidden_dims <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  <span class="co"># predicting 3 labels</span></span>
<span>  out_features <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  dropout <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use ADAM optimizer</span></span>
<span><span class="va">optimizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/optim_adam.html" class="external-link">optim_adam</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">parameters</span>, lr <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set our number of epochs</span></span>
<span><span class="va">n_epochs</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># create our training loop</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">epoch</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_epochs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">model</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">optimizer</span><span class="op">$</span><span class="fu">zero_grad</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">X</span>, <span class="va">adj</span><span class="op">)</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nnf_cross_entropy.html" class="external-link">nnf_cross_entropy</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">train_id</span>, <span class="op">]</span>, <span class="va">Y</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">train_id</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">loss</span><span class="op">$</span><span class="fu">backward</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">optimizer</span><span class="op">$</span><span class="fu">step</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">model</span><span class="op">$</span><span class="fu">eval</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://torch.mlverse.org/docs/reference/with_no_grad.html" class="external-link">with_no_grad</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">val_out</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">X</span>, <span class="va">adj</span><span class="op">)</span></span>
<span>    <span class="va">val_pred</span> <span class="op">&lt;-</span> <span class="va">val_out</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">val_id</span>, <span class="op">]</span><span class="op">$</span><span class="fu">argmax</span><span class="op">(</span>dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">val_acc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">val_pred</span> <span class="op">==</span> <span class="va">Y</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">val_id</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span></span>
<span>      dtype <span class="op">=</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_dtype.html" class="external-link">torch_float</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="fu">mean</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># print info every 20 epochs</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">epoch</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">20</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>      <span class="st">"Epoch %d | Loss: %.4f | Val Acc: %.4f\n"</span>,</span>
<span>      <span class="va">epoch</span>,</span>
<span>      <span class="va">loss</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="va">val_acc</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Epoch <span class="dv">20</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.8090</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.7933</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>Epoch <span class="dv">40</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.5746</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8357</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>Epoch <span class="dv">60</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.4738</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8491</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>Epoch <span class="dv">80</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.4336</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8595</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>Epoch <span class="dv">100</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.4034</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8648</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>Epoch <span class="dv">120</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.3803</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8671</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>Epoch <span class="dv">140</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.3683</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8689</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>Epoch <span class="dv">160</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.3611</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8722</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>Epoch <span class="dv">180</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.3499</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8722</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>Epoch <span class="dv">200</span> <span class="sc">|</span> Loss<span class="sc">:</span> <span class="fl">0.3436</span> <span class="sc">|</span> Val Acc<span class="sc">:</span> <span class="fl">0.8729</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">eval</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://torch.mlverse.org/docs/reference/with_no_grad.html" class="external-link">with_no_grad</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">test_out</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">X</span>, <span class="va">adj</span><span class="op">)</span></span>
<span>  <span class="va">test_pred</span> <span class="op">&lt;-</span> <span class="va">test_out</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">test_id</span>, <span class="op">]</span><span class="op">$</span><span class="fu">argmax</span><span class="op">(</span>dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">test_acc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">test_pred</span> <span class="op">==</span> <span class="va">Y</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">test_id</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span></span>
<span>    dtype <span class="op">=</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_dtype.html" class="external-link">torch_float</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="fu">mean</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Test Accuracy: %.4f\n"</span>, <span class="va">test_acc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Test Accuracy<span class="sc">:</span> <span class="fl">0.8694</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing torchgnn</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Josiah Parry <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9910-865X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Josiah Parry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
