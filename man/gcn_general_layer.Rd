% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/layer-gcn.R
\name{gcn_general_layer}
\alias{gcn_general_layer}
\title{Generalized GCN Layer (Hamilton 2020)}
\usage{
gcn_general_layer(in_features, out_features, bias = TRUE, normalize = FALSE)
}
\arguments{
\item{in_features}{Integer. Number of input features per node}

\item{out_features}{Integer. Number of output features per node}

\item{bias}{Logical. Add learnable bias term (\eqn{\Psi}). Default: TRUE}

\item{x}{Tensor \verb{n_nodes x in_features}. Node feature matrix}

\item{adj}{Tensor \verb{n_nodes x n_nodes}. Adjacency matrix. Expected to be row-normalized
\eqn{D^{-1}A} where \eqn{D} is the degree matrix. Can be binary or weighted.
This layer does NOT perform normalization internally}
}
\value{
Tensor \verb{n_nodes x out_features}. Transformed node features (before activation)
}
\description{
Implements a single Graph Convolutional Network (GCN) layer following Hamilton 2020:

\deqn{\mathbf{H}^{(k)} = \sigma\left(\mathbf{A}\mathbf{H}^{(k-1)}\mathbf{W}^{(k)}_{\text{neigh}} + \mathbf{H}^{(k-1)}\mathbf{W}^{(k)}_{\text{self}}\right)}

This can also be written as (Guo et al. 2025):

\deqn{\mathbf{X}^{(l)} = \sigma\left(\mathbf{D}^{-1}\mathbf{A}\mathbf{X}^{(l-1)}\boldsymbol{\Theta}^{(l)} + \mathbf{X}^{(l-1)}\boldsymbol{\Phi}^{(l)} + \boldsymbol{\Psi}^{(l)}\right)}

This layer combines:
\itemize{
\item Neighbor aggregation: \eqn{D^{-1}AX^{(l-1)}\Theta^{(l)}}
\item Self transformation: \eqn{X^{(l-1)}\Phi^{(l)}} focal node transformation
\item Global bias: \eqn{\Psi^{(l)}} additive bias term
}

Parameters:
\itemize{
\item \eqn{\Theta} (theta): \verb{in_features x out_features} transforms aggregated neighbor features
\item \eqn{\Phi} (phi): \verb{in_features x out_features} transforms node's own features
\item \eqn{\Psi} (psi): \code{out_features} global bias term (shared across all nodes)
}
}
\details{
The adjacency matrix is expected to be row-normalized \eqn{D^{-1}A} where \eqn{D}
is the degree matrix. This layer does NOT perform normalization internally.
}
\section{Forward pass}{

}

\references{
Hamilton, W. L. (2020). Graph Representation Learning. In Synthesis Lectures
on Artificial Intelligence and Machine Learning. Springer International
Publishing. \url{doi:10.1007/978-3-031-01588-5}

Guo, H., Wang, H., Zhu, D., Wu, L., Fotheringham, A. S., & Liu, Y. (2025).
RegionGCN: Spatial-Heterogeneity-Aware Graph Convolutional Networks. Annals
of the American Association of Geographers, 1â€“17.
\url{doi:10.1080/24694452.2025.2558661}
}
